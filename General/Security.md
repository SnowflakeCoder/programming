# Cross-origin resource sharing (CORS)

Cross-origin resource sharing (CORS) is a browser mechanism which <u>**enables controlled access to resources** located outside of a given domain</u>. It extends and adds flexibility to the **same-origin policy (SOP)**. However, it also provides potential for cross-domain based attacks, if a website's CORS policy is poorly configured and implemented. CORS is not a protection against cross-origin attacks such as **cross-site request forgery (CSRF)**.

# user authentication and authorization

**Authentication** is the process of **verifying who a user is**, while **authorization** is the process of verifying **what they have access to**. Authorization usually done after successful authentication. <u>Access to a resource is protected by both authentication and authorization</u>. If you can't prove your identity, you won't be allowed into a resource. And even if you can prove your identity, if you are not authorized for that resource, you will still be denied access.

Authentication is about **validating your credentials** such as Username/User ID and password to verify your identity. **Authentication factors** determine the many different elements the system uses to verify oneâ€™s identity before granting the individual access to anything. Based on the security level, authentication factors can vary from one of the following:

# OAUTH2

------

What is **OAUTH2**?

- Used for Authenticate an application.
- stands for **open authorization**.

Steps

1. client makes a request to the server.
2. server just sends back the **authorization code**.
3. client uses that authorization code and sends that code to the server
4. then the server returns to **access token**.
5. so with the help of this **access token** the user can access the API.

## Authorization Code

1. with the help of this **authorization** code you can **request certain scope information**.
2. User **grant access** to certain kind of scope which are available.
3. **authorization code is exchanged for access token**. Access token is granted by the server to the application.

## Scope

- scope is kind of for **what information** your app is exchanging for the user from the server.
-  it is the data to be accessed by the app.
- the **app request the data in the form of scopes**.
- There are Read scope and write scope.

### Redirect URL

- a specific URL that is assigned by the server.
- it is useful for checking if the client or the application is **valid or not**.
- this URL is **generated on the server side** and then the server redirects the user to this URL. (Ex: /Auth)

## Access Token

- Access Token is generated by the server.
- With the help of access token you can request information about the API or request user information

## Client ID and Client Secret

- This is part of the information that you have to setup before you can make your on OATH2 application.
-  These are two unique information that you want to store.

## Implementation

- implementing this in JavaScript.
- first of all you need to **create the client ID and the client secret**.
- creating these things initialize the Google JavaScript SDK for making the OAuth.
- request the **access token** from the application 
  - you pass the API key, client ID and the certain kind of scopes that you want in your application.
- request the user profile information after the successful sign-in.

------

## Basics of OAuth 2

- Applications can use **OAuth2 to authorize users** of his application by using a bank's external authorization server.
- application will delegate the responsibilities of user authorization to some other service rather than managing them on its own.
- The **3 high-level roles** that exist within anOAuth 2 framework are **user, the application and the API**.
- With in the API there is an **authentication server** and a **resource server**

For instance when you launch Spotify to listen to your music you may have chosen the **option to log in with Facebook** and Spotify requests access to your basic information and profile picture. **Spotify is the application** in this example and **Facebook is the API**.

- username & passwords are **never passed** around during the OAuth2 process.
- a prompt will tell you what permissions an application is requesting.

In our Spotify example Facebook's authorization screen **asked you to authorize Spotify to access your Facebook account information** and profile picture.

- Ones the user grants permission to Application to access her account API will grant authorization  along with an **authorization code** that application use when requesting an **access token** to see user account.
- Here comes the distinction in the API between the **authorization server** and the **resource server**. None of the resource details are located on the authorization server. This server is **only responsible for authorizing a user** and providing the proper **access token** specifically for that user and that will eventually allow application to retrieve resources of that user from the **resource server**. This token will be included in a request from Application to the resource server while requesting for user information. And resource server provide access to only the things that user granted it permission to see. Resource server will identifies that this token is valid to access those information and it sends the protected resources.
- **Oauth2 serves as the authorization framework** and the actual authentication of the user occurs with **Open ID Connect** through the use of ID token that are passed along with the access token.
- In order for all of this to work though **Application needed to register with the API service** and this is **independent of any user involvement**. Applications needs to provide the API with name, website and the URL to which **API authorization screen will redirect the user** after they have authorized access to their account.
- Once the application provides that necessary information to the API, the API will send back a **set of credentials** to application. These credentials include a **client ID which is a public** and unique identifier that will be used to identify the application and a **client secret** which is a **private identifier kept secret between the app and the API** that is **used to authenticate the application** when it makes a request for an access token.
- In OAuth-2 there are **four different grant types** for different use cases. The grant type that we used above is the **authorization code grant type**. This grant type is used **for applications running on web servers**. There are three additional grant types **implicit grants, password grants and client credentials grants**.



# Spring Boot Security - Introduction to OAuth2



![boot-39_3](https://www.javainuse.com/boot-39_3.jpg)



# What is JWT?



<img src="https://www.javainuse.com/63_6-min.JPG" alt="Structure of JWT" style="zoom:50%;" />



# Spring Boot Security + JWT Hello World Example

<img src="https://www.javainuse.com/62-12-min.JPG" alt="Spring Boot JWT Workflow" style="zoom:50%;" />



### Generating JWT

<img src="https://www.javainuse.com/62-2-min.JPG" alt="Spring Boot JWT Generate Token" style="zoom:50%;" />

### Validating JWT

<img src="https://www.javainuse.com/62-3-min.JPG" alt="Spring Boot JWT Validate Token" style="zoom:50%;" />

https://www.javainuse.com/spring/boot-jwt

